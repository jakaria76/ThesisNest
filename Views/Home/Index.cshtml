@model ThesisNest.Models.ViewModels.Home.HomeVm
@{
    ViewData["Title"] = "Home";
}

@section Styles {
    <style>
        /* ==== HOMEPAGE LUX DESIGN ==== */
        .hp-hero {
            position: relative;
            padding: clamp(2rem, 4vw, 3rem);
            border-radius: 18px;
            overflow: hidden;
            background: radial-gradient(1200px 300px at -10% -20%, rgba(13,110,253,.20), transparent 60%), radial-gradient(1200px 300px at 110% 120%, rgba(32,201,151,.20), transparent 60%), linear-gradient(135deg, rgba(13,110,253,.10), rgba(32,201,151,.10));
            border: 1px solid rgba(255,255,255,.15);
        }

            .hp-hero:before {
                content: "";
                position: absolute;
                inset: 0;
                background-image: linear-gradient(to right, rgba(255,255,255,.12) 1px, transparent 1px), linear-gradient(to bottom, rgba(255,255,255,.12) 1px, transparent 1px);
                background-size: 24px 24px;
                opacity: .2;
                pointer-events: none;
            }

        .hp-title {
            font-weight: 800;
            letter-spacing: -.02em;
        }

        .hp-sub {
            color: var(--bs-secondary-color);
            max-width: 720px
        }

        .kpi {
            backdrop-filter: blur(10px);
            background: rgba(255,255,255,.55);
            border: 1px solid rgba(255,255,255,.35);
            border-radius: 16px;
            padding: 1rem 1.2rem;
            transition: transform .18s ease, box-shadow .18s ease;
        }

        [data-theme="dark"] .kpi {
            background: rgba(18,18,20,.5);
            border-color: rgba(255,255,255,.08);
        }

        .kpi:hover {
            transform: translateY(-2px)
        }

        .kpi .kpi-label {
            color: var(--bs-secondary-color);
            font-size: .9rem
        }

        .kpi .kpi-value {
            font-size: 1.85rem;
            font-weight: 800
        }

        .quick .btn {
            border-radius: 12px;
            padding: .7rem 1rem;
            font-weight: 600;
        }

        .card-soft {
            border-radius: 16px;
            border: 1px solid rgba(0,0,0,.08);
        }

        [data-theme="dark"] .card-soft {
            border-color: rgba(255,255,255,.09);
            background: rgba(18,18,20,.55);
        }

        .list-clean .list-group-item {
            border: 0;
            padding: .75rem 0
        }

        .eyebrow {
            text-transform: uppercase;
            letter-spacing: .12em;
            font-size: .8rem;
            color: var(--bs-secondary-color)
        }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: .35rem;
            background: rgba(13,110,253,.1);
            color: #0d6efd;
            border-radius: 999px;
            padding: .25rem .6rem;
            font-size: .85rem
        }

        [data-theme="dark"] .pill {
            background: rgba(13,110,253,.18)
        }
    </style>
}

<div class="hp-hero mb-4">
    <div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between gap-3">
        <div>
            <div class="pill mb-2">
                <i class="bi bi-stars"></i> Streamlined Thesis Workflow
            </div>
            <h1 class="hp-title display-5 m-0">
                Hi, @Model.UserFullName ?? "there"! <span class="text-primary">Welcome to ThesisNest</span>
            </h1>
            <p class="hp-sub mt-2">
                One secured place for proposals, reviews, feedback, and real-time communication.
            </p>
            <div class="d-flex flex-wrap gap-2 mt-3">
                @if (Model.Role == "Student")
                {
                    <a class="btn btn-primary btn-lg" asp-controller="StudentThesis" asp-action="Create">
                        <i class="bi bi-upload"></i> Upload Proposal
                    </a>
                    <a class="btn btn-outline-secondary btn-lg" asp-controller="StudentThesis" asp-action="Index">
                        <i class="bi bi-journal-text"></i> My Submissions
                    </a>
                }
                else if (Model.Role == "Teacher")
                {
                    <a class="btn btn-primary btn-lg" asp-controller="ThesisReview" asp-action="Index">
                        <i class="bi bi-clipboard-check"></i> Review Theses
                    </a>
                    <a class="btn btn-outline-secondary btn-lg" asp-controller="Plagiarism" asp-action="Index">
                        <i class="bi bi-shield-check"></i> Plagiarism Checker
                    </a>
                }
                else if (Model.Role == "Admin")
                {
                    <a class="btn btn-primary btn-lg" asp-controller="AdminProposal" asp-action="Index">
                        <i class="bi bi-file-earmark-text"></i> Proposal Manage
                    </a>
                    <a class="btn btn-outline-secondary btn-lg" asp-controller="AdminTeacher" asp-action="Index">
                        <i class="bi bi-people"></i> Manage People
                    </a>
                }
                else
                {
                    <a class="btn btn-primary btn-lg" asp-controller="Account" asp-action="Login">
                        <i class="bi bi-box-arrow-in-right"></i> Get Started
                    </a>
                }
            </div>
        </div>
        <div class="text-center text-lg-end">
            <img src="~/images/hero-illustration.svg" alt="ThesisNest" style="max-width:360px;width:100%;opacity:.95">
        </div>
    </div>
</div>

@if (Model.Role == "Student")
{
    <div class="row g-3 mb-4">
        <div class="col-6 col-md-3">
            <div class="kpi h-100">
                <div class="kpi-label">My Submissions</div>
                <div class="kpi-value">@Model.MyTotalSubmissions</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="kpi h-100">
                <div class="kpi-label">Proposal Status</div>
                <div class="kpi-value">@Model.MyProposalStatus ?? "—"</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="kpi h-100">
                <div class="kpi-label">Feedback</div>
                <div class="kpi-value">@Model.MyFeedbackCount</div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="kpi h-100">
                <div class="kpi-label">Quick Links</div>
                <div class="d-grid gap-2 mt-2 quick">
                    <a class="btn btn-outline-secondary" asp-controller="StudentThesis" asp-action="Index"><i class="bi bi-journal-text"></i> My Submissions</a>
                    <a class="btn btn-outline-secondary" asp-controller="Resources" asp-action="Guidelines"><i class="bi bi-book"></i> Guidelines</a>
                </div>
            </div>
        </div>
    </div>

    <div class="row g-3">
        <div class="col-lg-6">
            <div class="card card-soft h-100">
                <div class="card-body">
                    <div class="eyebrow mb-2">Recent Activity</div>
                    @if (!Model.MyRecentActivities.Any())
                    {
                        <div class="text-muted">No recent updates.</div>
                    }
                    else
                    {
                        <ul class="list-group list-clean">
                            @foreach (var a in Model.MyRecentActivities)
                            {
                                <li class="list-group-item d-flex justify-content-between align-items-start">
                                    <div>
                                        <div class="fw-semibold">@a.Title</div>
                                        <div class="text-muted small">@a.Detail</div>
                                    </div>
                                    <small class="text-muted">@a.At.ToLocalTime()</small>
                                </li>
                            }
                        </ul>
                    }
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card card-soft h-100">
                <div class="card-body">
                    <div class="eyebrow mb-2">Resources</div>
                    <div class="row g-3">
                        <div class="col-12 col-md-6">
                            <a class="btn btn-outline-primary w-100" asp-controller="Resources" asp-action="Guidelines"><i class="bi bi-lightbulb"></i> How to write proposal</a>
                        </div>
                        <div class="col-12 col-md-6">
                            <a class="btn btn-outline-primary w-100" href="~/files/ThesisTemplate.docx"><i class="bi bi-file-earmark"></i> Template (DOCX)</a>
                        </div>
                        <div class="col-12">
                            <a class="btn btn-outline-secondary w-100" href="https://www.youtube.com" target="_blank" rel="noopener">
                                <i class="bi bi-play-circle"></i> Video walkthrough
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

@if (Model.Role == "Teacher")
{
    <div class="row g-3 mb-4">
        <div class="col-6 col-md-3"><div class="kpi h-100"><div class="kpi-label">Pending Reviews</div><div class="kpi-value">@Model.PendingReviews</div></div></div>
        <div class="col-6 col-md-3"><div class="kpi h-100"><div class="kpi-label">Ongoing</div><div class="kpi-value">@Model.OngoingCount</div></div></div>
        <div class="col-6 col-md-3"><div class="kpi h-100"><div class="kpi-label">Completed</div><div class="kpi-value">@Model.CompletedCount</div></div></div>
        <div class="col-6 col-md-3">
            <div class="kpi h-100">
                <div class="kpi-label">Quick</div>
                <div class="d-grid gap-2 mt-2 quick">
                    <a class="btn btn-outline-secondary" asp-controller="ThesisReview" asp-action="Index"><i class="bi bi-clipboard-check"></i> Review</a>
                    <a class="btn btn-outline-secondary" asp-controller="Plagiarism" asp-action="Index"><i class="bi bi-shield-check"></i> Plagiarism</a>
                </div>
            </div>
        </div>
    </div>

    <div class="card card-soft">
        <div class="card-body">
            <div class="eyebrow mb-2">Recent Submissions</div>
            @if (!Model.TeacherRecent.Any())
            {
                <div class="text-muted">No recent submissions.</div>
            }
            else
            {
                <ul class="list-group list-clean">
                    @foreach (var a in Model.TeacherRecent)
                    {
                        <li class="list-group-item d-flex justify-content-between">
                            <span><strong>@a.Title:</strong> @a.Detail</span>
                            <small class="text-muted">@a.At.ToLocalTime()</small>
                        </li>
                    }
                </ul>
            }
        </div>
    </div>
}

@if (Model.Role == "Admin")
{
    <div class="row g-3 mb-4">
        <div class="col-6 col-md-3"><div class="kpi h-100"><div class="kpi-label">Students</div><div class="kpi-value">@Model.TotalStudents</div></div></div>
        <div class="col-6 col-md-3"><div class="kpi h-100"><div class="kpi-label">Teachers</div><div class="kpi-value">@Model.TotalTeachers</div></div></div>
        <div class="col-6 col-md-3"><div class="kpi h-100"><div class="kpi-label">Proposals (7d)</div><div class="kpi-value">@Model.ProposalsThisWeek</div></div></div>
        <div class="col-6 col-md-3">
            <div class="kpi h-100">
                <div class="kpi-label">Quick</div>
                <div class="d-grid gap-2 mt-2 quick">
                    <a class="btn btn-outline-secondary" asp-controller="AdminProposal" asp-action="Index"><i class="bi bi-file-earmark-text"></i> Proposal</a>
                    <a class="btn btn-outline-secondary" asp-controller="AdminTeacher" asp-action="Index"><i class="bi bi-people"></i> Teachers</a>
                    <a class="btn btn-outline-secondary" asp-controller="AdminStudent" asp-action="Index"><i class="bi bi-person-badge"></i> Students</a>
                </div>
            </div>
        </div>
    </div>

    <div class="row g-3">
        <div class="col-lg-6">
            <div class="card card-soft h-100">
                <div class="card-body">
                    <div class="eyebrow mb-2">Recent Site Activity</div>
                    @if (!Model.SiteRecent.Any())
                    {
                        <div class="text-muted">No recent uploads.</div>
                    }
                    else
                    {
                        <ul class="list-group list-clean">
                            @foreach (var a in Model.SiteRecent)
                            {
                                <li class="list-group-item d-flex justify-content-between">
                                    <span><strong>@a.Title:</strong> @a.Detail</span>
                                    <small class="text-muted">@a.At.ToLocalTime()</small>
                                </li>
                            }
                        </ul>
                    }
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="card card-soft h-100">
                <div class="card-body">
                    <div class="eyebrow mb-2">Announcements & Deadlines</div>
                    <div class="row">
                        <div class="col-12 col-md-6">
                            <div class="fw-semibold mb-2">Announcements</div>
                            @if (!Model.Notices.Any())
                            {
                                <div class="text-muted">No announcements.</div>
                            }
                            else
                            {
                                <ul class="list-unstyled m-0">
                                    @foreach (var n in Model.Notices)
                                    {
                                        <li class="mb-2">• <a href="@n.Url">@n.Title</a></li>
                                    }
                                </ul>
                            }
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="fw-semibold mb-2">Deadlines</div>
                            @if (!Model.Deadlines.Any())
                            {
                                <div class="text-muted">No deadlines.</div>
                            }
                            else
                            {
                                <ul class="list-unstyled m-0">
                                    @foreach (var d in Model.Deadlines)
                                    {
                                        <li class="mb-2 d-flex justify-content-between">
                                            <span>@d.Title</span>
                                            <span class="text-muted">@d.DueAt.ToString("MMM dd, yyyy")</span>
                                        </li>
                                    }
                                </ul>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

@if (Model.Role == "Guest")
{
    <div class="card card-soft mt-4">
        <div class="card-body d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3">
            <div>
                <div class="eyebrow">Get Started</div>
                <div class="h5 m-0">Create an account and submit your thesis proposal today.</div>
            </div>
            <div>
                <a class="btn btn-primary me-2" asp-controller="Account" asp-action="Register">Register</a>
                <a class="btn btn-outline-secondary" asp-controller="Account" asp-action="Login">Login</a>
            </div>
        </div>
    </div>
}
