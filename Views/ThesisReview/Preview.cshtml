@{
    ViewData["Title"] = "Preview File";
    string baseUrl = $"{Context.Request.Scheme}://{Context.Request.Host}";
    string fileUrl = ViewBag.FileUrl as string;
    string fullFileUrl = baseUrl + fileUrl;
}

<div class="container py-4">
    <h3 class="mb-3">Preview</h3>
    <a asp-action="Index" class="btn btn-outline-secondary mb-3">Back</a>

    @if (ViewBag.PreviewType == "pdf")
    {
        <iframe src="@fileUrl" width="100%" height="800px" style="border:none;"></iframe>
    }
    else if (ViewBag.PreviewType == "doc")
    {
        <iframe src="https://view.officeapps.live.com/op/embed.aspx?src=@fullFileUrl"
                width="100%" height="800px" style="border:none;"></iframe>
    }
    else
    {
        <p class="text-danger">Preview not available for this file type.</p>
        <a asp-action="DownloadVersion" asp-route-versionId="@ViewBag.ThesisVersionId" class="btn btn-primary mt-2">Download File</a>
    }
</div>
