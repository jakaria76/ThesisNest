@model ThesisNest.Models.ViewModels.ThesisIndexVm
@using ThesisNest.Models
@{
    ViewData["Title"] = "My Submissions";
    int totalPages = (int)Math.Ceiling((double)Model.TotalCount / Model.PageSize);
}
<div class="d-flex align-items-center mb-3">
    <h5 class="m-0">My Submissions</h5>
    <a asp-action="Create" class="btn btn-primary ms-auto"><i class="bi bi-cloud-upload me-1"></i> Upload Proposal</a>
</div>

@if (TempData["Success"] != null)
{
    <div class="alert alert-success">@TempData["Success"]</div>
}
@if (TempData["Error"] != null)
{
    <div class="alert alert-danger">@TempData["Error"]</div>
}

@if (Model.Items?.Count == 0)
{
    <div class="alert alert-info">No submissions yet. Upload your first proposal!</div>
}
else
{
    <div class="list-group shadow-sm">
        @foreach (var it in Model.Items)
        {
            <a asp-action="Details" asp-route-id="@it.Id" class="list-group-item list-group-item-action d-flex align-items-center">
                <div class="me-3"><span class="badge bg-secondary">v@it.CurrentVersionNo</span></div>
                <div class="flex-grow-1">
                    <div class="fw-semibold">@it.Title</div>
                    <div class="text-muted small">@it.Department • @it.CreatedAtStr</div>
                </div>
                <div class="ms-3">
                    @await Html.PartialAsync("~/Views/Shared/Partials/_ProposalStatusBadge.cshtml", it.ProposalStatus)
                </div>
            </a>
        }
    </div>
}
